@page "/counter"

@inject IJSRuntime js

<h1>Counter</h1>

<p>Current count: @(alerts?.Count() ?? 0)</p>

<button class="btn btn-primary" @onclick="AddAlert">Add alert</button>

<ListComponent Items="alerts" Context="alert">
    <NullTemplate>
        <p>Wait till we build this for you</p>
    </NullTemplate>
    <EmptyTemplate>
        <p>Nothing to see here, move on</p>
    </EmptyTemplate>
    <ElementTemplate>
        <AlertMessage DeleteAlert="DeleteAlert" Alert="alert">
            <span>This is an alert @alert</span>
        </AlertMessage>
    </ElementTemplate>
</ListComponent>

@code {
    private List<int> alerts;

    protected override async Task OnInitializedAsync()
    {
        await Task.Delay(2000);
        alerts = new List<int>();
    }

    private void AddAlert()
    {
        alerts.Add(alerts.DefaultIfEmpty(0).Max() + 1);
    }

    private async Task DeleteAlert(object item)
    {
        var confirmed = await js.Confirm($"Are you sure you want to delete alert {item}");

        if (confirmed)
        {
            alerts.Remove((int)item);
        }
    }
}